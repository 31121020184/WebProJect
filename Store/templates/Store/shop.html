{% extends "Store/base.html" %}
{% load static %}
{% block body %}
<div class="header-inner">
    <div class="container">
        <div class="cat-nav-head">
            <div class="row">
                <div class="col-lg-12 col-12">
                    <div class="menu-area">
                        <!-- Main Menu -->
                        <nav class="navbar navbar-expand-lg">
                            <div class="collapse navbar-collapse" id="navbarNav">
                                <ul class="nav main-menu menu navbar-nav mx-auto">
                                    <li class="nav-item"><a class="nav-link" href="{% url 'Store:index' %}">Trang Chủ</a></li>
                                    <li class="nav-item"><a class="nav-link" href="{% url 'Store:nuoc-hoa-nam' %}">NƯỚC HOA NAM</a></li>
                                    <li class="nav-item"><a class="nav-link" href="{% url 'Store:nuoc-hoa-nu' %}">NƯỚC HOA NỮ</a></li>
                                    <li class="nav-item"><a class="nav-link" href="{% url 'Store:unisex' %}">UNISEX</a></li>
                                    <li class="nav-item"><a class="nav-link" href="{% url 'Store:thuong-hieu'%}">Thương Hiệu</a></li>
                                    <li class="nav-item"><a class="nav-link" href="{% url 'Store:khuyen-mai' %}">Khuyến Mãi</a></li>
                                    <li class="nav-item"><a class="nav-link" href="{% url 'Store:tin-tuc' %}">Tin Tức</a></li>
                                    <li class="nav-item"><a class="nav-link" href="{% url 'Store:lien-he' %}">Liên Hệ</a></li>
                                </ul>
                            </div>
                        </nav>
                        <!--/ End Main Menu -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</header>
<div class="breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="bread-inner text-center">
                    <h4>Sản phẩm</h4> 
                    <ul class="bread-list">
                        <li><a href="{% url 'Store:index' %}">Trang chủ<i class="ti-arrow-right"></i></a></li>
                        <li class="active"><a href="{% url 'Store:shop'%}">Sản phẩm</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<section class="product-area shop-sidebar shop section">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 col-md-4 col-12">
                <div class="shop-sidebar">
                        <!-- Single Widget -->
                        <div class="single-widget category">
                            <h3 class="title">Danh mục</h3>
                            <ul class="categor-list">
                                <li><a href="{% url 'Store:nuoc-hoa-nam'%}">Nước hoa nam</a></li>
                                <li><a href="{% url 'Store:nuoc-hoa-nu'%}">Nước hoa nữ</a></li>
                                <li><a href="{% url 'Store:unisex'%}">Unisex</a></li>
                            </ul>
                        </div>
                        <!--/ End Single Widget -->
                        <!-- Shop By Price -->
                        <div class="single-widget range">
                            <span class="title">Khoảng giá</span>
                            <div class="price-filter">
                                <!-- <form action="{% url 'Store:price_filter' %}" method="GET" name="filter_price">
                                    <input type="hidden" name="subcategory_id_1"
                                      
                                         value="{% if subcategory %}{{ subcategory }}{% elif pk %}{{ pk }}{% else %}0{% endif %}">								
                                    <input type="hidden" name="name_1" value="{{ search_str }}">
                        
                                    <div class="price-input">
                                        <input type="number" min="10000" placeholder="Giá từ" value="100000"
                                            title="Nhập giá từ 100000 trở lên" name="price_from" required />
                                        <span>đ</span>
                                    </div>
                                    <span>đến</span>
                                    <div class="price-input">
                                        <input type="number" min="10000" placeholder="Giá đến"
                                            value="200000" title="Nhập giá từ 10000 trở lên" name="price_to" required />đ
                                    </div>								
                                    <input type="submit" class="btn" value="Tìm">
                                </form> -->
                                <form action="{% url 'Store:price_filter' %}" method="GET">
                                    {% if category_id %}
                                    <input type="hidden" name="category_id" value="{{ category_id }}">
                                    {% endif %}
                                    
                                    <input type="hidden" name="name_1" value="{{ search_str|default:'' }}">
                                    
                                    <div class="price-input">
                                        <input type="number" min="0" name="price_from" 
                                               value="{{ price_from|default:'1000000' }}"
                                               placeholder="Giá từ" required>
                                        <span>đ</span>
                                    </div>
                                    <span>đến</span>
                                    <div class="price-input">
                                        <input type="number" min="0" name="price_to" 
                                               value="{{ price_to|default:'3000000' }}"
                                               placeholder="Giá đến" required>
                                        <span>đ</span>
                                    </div>
                                    <button type="submit" class="btn">Tìm kiếm</button>
                                </form>
                            </div>
                        </div>
                            <!--/ End Shop By Price -->
                        <!-- Single Widget -->
                        <div class="single-widget recent-post">
                            <h3 class="title">Hàng mới về</h3>
                            {% if three_newest %}
                            <!-- Single Post -->
                             {% for product in three_newest %}
                            <div class="single-post first">
                                <div class="image">
                                    <img src="{{product.image.url}}" alt="{{product.name}}">
                                </div>
                                <div class="content">
                                    <h5><a href="{% url 'Store:shop'%}">{{product.name}}</a></h5>
                                    <p class="price">{% load humanize %}{{product.price|floatformat:0|intcomma}} đ</p>
                                    <ul class="reviews">
                                        <li class="yellow"><i class="ti-star"></i></li>
                                        <li class="yellow"><i class="ti-star"></i></li>
                                        <li class="yellow"><i class="ti-star"></i></li>
                                        <li><i class="ti-star"></i></li>
                                        <li><i class="ti-star"></i></li>
                                    </ul>
                                </div>
                            </div>
                            {% endfor %}
                            {% endif %}
                        </div>
                        <!--/ End Single Widget -->								
                </div>
            </div>
            <div class="col-lg-9 col-md-8 col-12">
                <div class="row">
                    <div class="col-12">
                        <!-- Shop Top -->
                        <div class="shop-top">
							<div class="shop-shorter">
                                <div class="single-shorter"> 
                                    <h6 style="color: red;">{{ result }}</h6>
                                    {% if search_str %}
                                        {% if product_items > 0 %}
                                            {% comment %} <h7 style="color: red;">Tìm thấy {{ product_items }} sản phẩm có từ '{{ search_str }}'</h7> {% endcomment %}
                                        {% else %}
                                            {% comment %} <h7 style="color: red;">Không tìm thấy sản phẩm nào!</h7> {% endcomment %}
                                        {% endif %}
                                    {% endif %}
                                </div>
							</div>
							<ul class="view-mode">
								<li class="active"><a href="{% url 'Store:shop' %}"><i
											class="fa fa-th-large"></i></a></li>

							</ul>
						</div>
                        <!--/ End Shop Top -->
                    </div>
                </div>
                <div class="row">
                    {% if products %}
                    {% for product in products%}
                    <div class="col-lg-4 col-md-6 col-12">
                        <div class="single-product">
                            <div class="product-img">
                                <a href="{% url 'Store:shop' %}">
                                    <img class="default-img" src="{{product.image.url}}" alt="{{product.name}}">
                                    <img class="hover-img" src="{{product.image.url}}" alt="{{product.name}}">
                                </a>
                                <div class="button-head">
                                    <div class="product-action-2">
                                        <form action="{% url 'cart:cart_add' product.id %}" method="POST">
                                            {% csrf_token %}
                                            <input type="hidden" name="quantity" value="1">
                                        <input type="submit" value="Chọn mua" class="btn btn-warning">
                                    </form>
                                    </div>
                                    <div class="product-action">
                                        <!-- <a data-toggle="modal" data-target="#exampleModal" href="#" class="quick-view">
                                            <i class=" ti-eye"></i>
                                             <span>Xem nhanh</span> 
                                        </a> -->
                                        <a data-toggle="modal" data-target="#productModal" 
                                            data-id="{{ product.id }}"
                                            data-name="{{ product.name }}"
                                            data-price="{{ product.price }}"
                                            data-image="{{ product.image.url }}"
                                            data-gioi-tinh="{{ product.gioi_tinh }}"
                                            data-brand="{{ product.brand }}"
                                            data-release-year="{{ product.nam_san_xuat }}"
                                            data-nhom-huong="{{ product.nhom_nuoc_hoa }}"
                                            data-huong-dau="{{ product.huong_dau }}"
                                            data-huong-giua="{{ product.huong_giua }}"
                                            data-huong-cuoi="{{ product.huong_cuoi }}"
                                            data-phong-cach="{{ product.phong_cach }}"
                                            data-luu-huong="{{ product.thoi_gian_luu_huong}}"
                                            data-nong-do="{{ product.nong_do }}"
                                            onclick="setProductInfo(this)">
                                                <i class="ti-eye"></i>
                                                <span>Xem nhanh</span>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <div class="product-content">
                                <h3><a href="{% url 'Store:san-pham' product.pk %}">{{product.name}}</a></h3>
                                <div class="product-price">
                                    <span class="old">{% load humanize %}{{product.price_origin|floatformat:0|intcomma}} đ</span>
                                    <span>{% load humanize %}{{product.price|floatformat:0|intcomma}} đ</span>
                                </div>
                                <div class="product-icon">
                                    <i class="fa-solid fa-star"></i>
                                    <i class="fa-solid fa-star"></i>
                                    <i class="fa-solid fa-star"></i>
                                    <i class="fa-solid fa-star"></i>
                                    <i class="fa-solid fa-star"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                    {% endif %}
                </div>	
                <div class="row">
					<div class="col-12 text-center pb-4 pt-4">
						{% if products.has_other_pages %}
						{% if products.has_previous %}
						<a href="?page={{ products.previous_page_number }}
						{% if request.GET.subcategory_id %}&subcategory_id={{ request.GET.subcategory_id }}{% endif %}
						{% if request.GET.name %}&name={{ request.GET.name}}{% endif %}
						{% if request.GET.subcategory_id_1 %}&subcategory_id_1={{ request.GET.subcategory_id_1 }}{% endif %}
						{% if request.GET.name_1 %}&name_1={{ request.GET.name_1}}{% endif %}
						{% if request.GET.price_from %}&price_from={{ request.GET.price_from}}{% endif %}
						{% if request.GET.price_to %}&price_to={{ request.GET.price_to}}{% endif %}"
							class="btn_mange_pagging"><i class="fa fa-long-arrow-left"></i>&nbsp;&nbsp; Trước-</a>
						{% else %}
						<div class="disabled"><span></span></div>
						{% endif %}
						{% for i in products.paginator.page_range %}
						{% if products.number == i %}
						<a href="?page={{ i }}
						{% if request.GET.subcategory_id %}&subcategory_id={{ request.GET.subcategory_id }}{% endif %}
						{% if request.GET.name %}&name={{ request.GET.name}}{% endif %}
						{% if request.GET.subcategory_id_1 %}&subcategory_id_1={{ request.GET.subcategory_id_1 }}{% endif %}
						{% if request.GET.name_1 %}&name_1={{ request.GET.name_1}}{% endif %}
						{% if request.GET.price_from %}&price_from={{ request.GET.price_from}}{% endif %}
						{% if request.GET.price_to %}&price_to={{ request.GET.price_to}}{% endif %}" 
						class="active">{{i}}-</a>
						{% else %}
						<a href="?page={{ i }}
						{% if request.GET.subcategory_id %}&subcategory_id={{ request.GET.subcategory_id }}{% endif %}
						{% if request.GET.name %}&name={{ request.GET.name}}{% endif %}
						{% if request.GET.subcategory_id_1 %}&subcategory_id_1={{ request.GET.subcategory_id_1 }}{% endif %}
						{% if request.GET.name_1 %}&name_1={{ request.GET.name_1}}{% endif %}
						{% if request.GET.price_from %}&price_from={{ request.GET.price_from}}{% endif %}
						{% if request.GET.price_to %}&price_to={{ request.GET.price_to}}{% endif %}"
						class="btn_pagging">{{i}}-</a>
						{% endif %}
						{% endfor %}
						{% if products.has_next %}
						<a href="?page={{ products.next_page_number }}
						{% if request.GET.subcategory_id %}&subcategory_id={{ request.GET.subcategory_id }}{% endif %}
						{% if request.GET.name %}&name={{ request.GET.name}}{% endif %}
						{% if request.GET.subcategory_id_1 %}&subcategory_id_1={{ request.GET.subcategory_id_1 }}{% endif %}
						{% if request.GET.name_1 %}&name_1={{ request.GET.name_1}}{% endif %}
						{% if request.GET.price_from %}&price_from={{ request.GET.price_from}}{% endif %}
						{% if request.GET.price_to %}&price_to={{ request.GET.price_to}}{% endif %}"
						class="btn_mange_pagging">Sau <i class="fa fa-long-arrow-right"></i>&nbsp;&nbsp; </a>
						{% else %}
						<div class="disabled"><span></span></div>
						{% endif %}
						{% endif %}
					</div>
				</div>				
            </div>
        </div>
    </div>
</section>
{% endblock %}